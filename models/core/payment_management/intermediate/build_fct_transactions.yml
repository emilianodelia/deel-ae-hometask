version: 2

models:
  - name: build_fct_transactions
    description: >
     Intermediate version for the reporting model that stores Globepay transactions along
     with their corresponding accetance rate and chargeback status
    columns:
      - name: event_id
        description: '{{ doc("event_id") }}'
        data_tests:
          - unique:
              config:
                severity: error
          - not_null:
              config:
                severity: error
      
      - name: transaction_id
        description: '{{ doc("transaction_id") }}'
        data_tests:
          - unique:
              config:
                severity: error
          - not_null:
              config:
                severity: error

      - name: transaction_status
        description: '{{ doc("transaction_status") }}'
        data_tests:
          - accepted_values:
              arguments:
                values: ['ACCEPTED', 'DECLINED']
              config:
                severity: warn
      
      - name: processed_at
        description: '{{ doc("processed_at") }}'
        data_tests:
          - not_null:
              config:
                severity: warn